## garuda-mail (Netcup VPS)

### General

This system mainly consists of the [simple-nixos-mailserver](https://gitlab.com/simple-nixos-mailserver/nixos-mailserver). Its only purpose is providing a mail service to team members. The current config looks like [this](https://gitlab.com/garuda-linux/infra-nix/-/blob/main/nixos/hosts/garuda-mail.nix?ref_type=heads#L47).
In case of issues, the [documentation](https://nixos-mailserver.readthedocs.io/en/latest/) can be consulted.

### Mail server setup

The mail server details are as follows:

- host: mail.garudalinux.net
- incoming: IMAP via 993
- outgoing: SMTP via 587/465

### Backups

Backups are happening daily via Borg. A Hetzner storage box is used to store multiple generations of backups.

### Creating a new user

A new user can be created be adding a new `loginAccounts` value and supplying the password via `secrets`. We make use of `hashedPasswordFile`, therefore new hashes can be generated by running `nix-shell -p mkpasswd --run 'mkpasswd -sm bcrypt'`. Add it to the `secrets`, `deploy` and `apply`. Don't forget to commit both changes.
